# Main nginx configuration for bench {{ bench_name }}
# Generated by frappe-manager

{% for site in sites %}
# Include {{ site.name }} configuration
include /etc/nginx/conf.d/{{ site.name }}.conf;
{% endfor %}

# Default server block (fallback)
server {
    listen 80 default_server;
    listen [::]:80 default_server;
    
    {% if default_site %}
    # Redirect to default site
    return 301 http://{{ default_site.name }}$request_uri;
    {% else %}
    # No sites configured - return 444 (connection closed)
    return 444;
    {% endif %}
}

